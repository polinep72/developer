# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é —Å–∏—Å—Ç–µ–º—ã

–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é —Å–∏—Å—Ç–µ–º—ã —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞ –∏ –¥—Ä—É–≥–∏—Ö –∞—Å–ø–µ–∫—Ç–æ–≤.

**–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-12-16  
**–í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã:** 1.4.13

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (—Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

#### 1. ‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.3.6**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω–∏–ª–∏—Å—å –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–ª–∏—Å—å –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ.  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –≤—Å–µ –ø–∞—Ä–æ–ª–∏ —Ç–µ–ø–µ—Ä—å —Ö–µ—à–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `werkzeug.security`  
**–í–µ—Ä—Å–∏—è:** 1.3.6 (2025-12-12)

---

#### 2. ‚úÖ –°–ª–∞–±—ã–π SECRET_KEY –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.3.6**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π –∫–ª—é—á.  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - SECRET_KEY —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ .env  
**–í–µ—Ä—Å–∏—è:** 1.3.6 (2025-12-12)

---

#### 3. ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç CSRF - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.0**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏ –º–µ–∂—Å–∞–π—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.  
**–†–∏—Å–∫:** –ê—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ –ø–æ–¥–¥–µ–ª–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –Ω–∞ –¥—Ä—É–≥–∏—Ö —Å–∞–π—Ç–∞—Ö.

**–†–µ—à–µ–Ω–∏–µ:**
```python
from flask_wtf.csrf import CSRFProtect

csrf = CSRFProtect(_flask_app)

# –í —à–∞–±–ª–æ–Ω–∞—Ö –¥–ª—è —Ñ–æ—Ä–º
<form method="post">
    {{ csrf_token() }}
    <!-- –∏–ª–∏ -->
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
    ...
</form>

# –î–ª—è AJAX –∑–∞–ø—Ä–æ—Å–æ–≤
<script>
    const csrfToken = "{{ csrf_token() }}";
    fetch('/some-endpoint', {
        method: 'POST',
        headers: {
            'X-CSRFToken': csrfToken,
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    });
</script>
```

---

#### 4. ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting –¥–ª—è –ª–æ–≥–∏–Ω–∞ - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.1**
**–ü—Ä–æ–±–ª–µ–º–∞:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ –ø–∞—Ä–æ–ª–µ–π –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.  
**–†–∏—Å–∫:** –ü–µ—Ä–µ–±–æ—Ä –ø–∞—Ä–æ–ª–µ–π –º–µ—Ç–æ–¥–æ–º –≥—Ä—É–±–æ–π —Å–∏–ª—ã.

**–†–µ—à–µ–Ω–∏–µ:**
```python
from flask_limiter import Limiter
from flask_limiter.util import get_remote_address

limiter = Limiter(
    _flask_app,
    key_func=get_remote_address,
    default_limits=["200 per day", "50 per hour"],
    storage_uri="memory://"  # –∏–ª–∏ Redis –¥–ª—è production
)

@_flask_app.route('/login', methods=['POST'])
@limiter.limit("5 per minute")
def login():
    ...
```

---

### –í–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### 5. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.0**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞.  
**–†–∏—Å–∫:** XSS –∞—Ç–∞–∫–∏, –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ë–î.

**–†–µ—à–µ–Ω–∏–µ:**
```python
import bleach
from werkzeug.utils import escape
import re

# –í–∞–ª–∏–¥–∞—Ü–∏—è username
def validate_username(username):
    if not username or len(username) < 3 or len(username) > 50:
        raise ValueError("–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 3 –¥–æ 50 —Å–∏–º–≤–æ–ª–æ–≤")
    if not re.match(r'^[a-zA-Z0-9_-]+$', username):
        raise ValueError("–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, –¥–µ—Ñ–∏—Å –∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ")
    return username.strip().lower()

# –í–∞–ª–∏–¥–∞—Ü–∏—è email
def validate_email(email):
    if email and email.strip():
        email_pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        if not re.match(email_pattern, email):
            raise ValueError("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email")
    return email.strip().lower() if email else None

# –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è HTML –≤—ã–≤–æ–¥–∞
clean_note = bleach.clean(user_note, tags=[], strip=True)  # –£–¥–∞–ª—è–µ—Ç –≤—Å–µ HTML —Ç–µ–≥–∏
```

---

#### 6. ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (Audit Log) - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.2**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∞—É–¥–∏—Ç–∞.  
**–†–∏—Å–∫:** –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∫—Ç–æ –∏ –∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω–∏–ª –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

**–†–µ—à–µ–Ω–∏–µ:**
```sql
CREATE TABLE IF NOT EXISTS audit_log (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    action_type VARCHAR(50) NOT NULL,  -- 'login', 'logout', 'create', 'update', 'delete', 'export'
    table_name VARCHAR(50),
    record_id INTEGER,
    details TEXT,
    ip_address INET,
    user_agent TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_audit_log_user_id ON audit_log(user_id);
CREATE INDEX idx_audit_log_created_at ON audit_log(created_at);
CREATE INDEX idx_audit_log_action_type ON audit_log(action_type);
```

```python
def log_user_action(action_type, table_name=None, record_id=None, details=None, user_id=None):
    """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –∞—É–¥–∏—Ç–∞"""
    user_id = user_id or session.get('user_id')
    ip_address = request.remote_addr
    user_agent = request.headers.get('User-Agent', '')
    
    query = """
        INSERT INTO audit_log (user_id, action_type, table_name, record_id, details, ip_address, user_agent)
        VALUES (%s, %s, %s, %s, %s, %s, %s)
    """
    try:
        execute_query(query, (user_id, action_type, table_name, record_id, str(details), ip_address, user_agent), fetch=False)
    except Exception as e:
        _flask_app.logger.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏ –≤ audit_log: {e}")

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
log_user_action('login', details={'username': username})
log_user_action('update', table_name='users', record_id=user_id, details={'field': 'email'})
```

---

#### 7. ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–π - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.2**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è MD5 –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö ID, —Å–ª–∞–±—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ cookie.  
**–†–∏—Å–∫:** –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞—â–∏—Ç—ã cookie.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ:**
- –í `get_temp_user_id()` MD5 –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ SHA-256 –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ `temp_user_id`
- –î–æ–±–∞–≤–ª–µ–Ω—ã –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ cookie –≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
  - `SESSION_COOKIE_SECURE = True`
  - `SESSION_COOKIE_HTTPONLY = True`
  - `SESSION_COOKIE_SAMESITE = 'Lax'`
  - `PERMANENT_SESSION_LIFETIME = timedelta(hours=8)`

---

#### 8. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω —Ç–∞–±–ª–∏—Ü –∏ —Å—Ç–æ–ª–±—Ü–æ–≤ - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.3**
**–ü—Ä–æ–±–ª–µ–º–∞:** –í `get_or_create_id()` –∏ –ø–æ–¥–æ–±–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö –∏–º–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏.  
**–†–∏—Å–∫:** SQL injection —á–µ—Ä–µ–∑ –∏–º–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü/—Å—Ç–æ–ª–±—Ü–æ–≤ (—Ö–æ—Ç—è —Ä–∏—Å–∫ –Ω–∏–∑–∫–∏–π, —Ç.–∫. –æ–Ω–∏ –∏–∑ –∫–æ–¥–∞).
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã whitelist —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –∏ —Å—Ç–æ–ª–±—Ü–æ–≤, —Ñ—É–Ω–∫—Ü–∏–∏ `validate_table_name()` –∏ `validate_column_name()`  
**–í–µ—Ä—Å–∏—è:** 1.4.3 (2025-12-16)

**–†–µ—à–µ–Ω–∏–µ:**
```python
ALLOWED_TABLES = {
    'users', 'invoice', 'invoice_p', 'invoice_f',
    'consumption', 'consumption_p', 'consumption_f',
    'cart', 'pr', 'tech', 'lot', 'wafer', 'quad', 'in_lot', 'n_chip',
    'stor', 'cells', 'start_p', 'chip', 'pack', 'status'
}

ALLOWED_COLUMNS = {
    'username', 'email', 'name_pr', 'name_tech', 'name_lot', 
    'name_wafer', 'name_quad', 'in_lot', 'n_chip', 'name_stor', 
    'name_cells', 'name_start', 'name_chip', 'name_pack'
}

def get_or_create_id(table_name, column_name, value):
    if table_name not in ALLOWED_TABLES:
        raise ValueError(f"–ù–µ–¥–æ–ø—É—Å—Ç–∏–º–æ–µ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã: {table_name}")
    if column_name not in ALLOWED_COLUMNS:
        raise ValueError(f"–ù–µ–¥–æ–ø—É—Å—Ç–∏–º–æ–µ –∏–º—è —Å—Ç–æ–ª–±—Ü–∞: {column_name}")
    
    # –î–∞–ª–µ–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥...
```

---

#### 9. ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.4**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π.  
**–†–∏—Å–∫:** DoS –∞—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã, –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏.
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω MAX_FILE_SIZE = 10 MB, –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `/inflow`, `/outflow`, `/refund`, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–∫–∏ 413  
**–í–µ—Ä—Å–∏—è:** 1.4.4 (2025-12-16)

**–†–µ—à–µ–Ω–∏–µ:**
```python
MAX_FILE_SIZE = 10 * 1024 * 1024  # 10 MB

@_flask_app.route('/inflow', methods=['POST'])
def inflow():
    file = request.files.get('file')
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
    file.seek(0, 2)  # –ü–µ—Ä–µ—Ö–æ–¥ –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞
    file_size = file.tell()
    file.seek(0)  # –í–æ–∑–≤—Ä–∞—Ç –≤ –Ω–∞—á–∞–ª–æ
    
    if file_size > MAX_FILE_SIZE:
        return jsonify({"success": False, "message": f"–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: {MAX_FILE_SIZE / 1024 / 1024} MB"}), 400
    
    # –¢–∞–∫–∂–µ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Flask
    _flask_app.config['MAX_CONTENT_LENGTH'] = MAX_FILE_SIZE
```

---

#### 10. ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.5**
**–ü—Ä–æ–±–ª–µ–º–∞:** –†–∞–∑–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ –ø—Ä–∏ –Ω–µ–≤–µ—Ä–Ω–æ–º –ª–æ–≥–∏–Ω–µ/–ø–∞—Ä–æ–ª–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.  
**–†–∏—Å–∫:** –£—Ç–µ—á–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö.
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –µ–¥–∏–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ, –∑–∞–¥–µ—Ä–∂–∫–∞ 500ms –ø–µ—Ä–µ–¥ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –æ—à–∏–±–∫–∏, –∑–∞—â–∏—Ç–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `forgot_password`  
**–í–µ—Ä—Å–∏—è:** 1.4.5 (2025-12-16)

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
if not user_data_list or not check_password_hash(db_password, u_password):
    # –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∑–∞–º–µ–¥–ª–µ–Ω–∏—è –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
    import time
    time.sleep(0.5)
    flash("–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å.", "danger")
    return render_template('login.html')
```

---

## üé® –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç (UX/UI)

### 1. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.6**
**–ü—Ä–æ–±–ª–µ–º–∞:** –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∑–Ω–∞–µ—Ç –æ–± –æ—à–∏–±–∫–∞—Ö –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏.
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ HTML5 –≤–∞–ª–∏–¥–∞—Ü–∏—è, toast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –≤–∏–∑—É–∞–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å  
**–í–µ—Ä—Å–∏—è:** 1.4.6 (2025-12-16)

**–†–µ—à–µ–Ω–∏–µ:**
```html
<!-- HTML5 –≤–∞–ª–∏–¥–∞—Ü–∏—è -->
<input type="text" 
       name="username" 
       required 
       minlength="3" 
       maxlength="50"
       pattern="[a-zA-Z0-9_-]+"
       title="–¢–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, –¥–µ—Ñ–∏—Å –∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ"
       autocomplete="username">

<!-- JavaScript –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π -->
<script>
function validateForm(form) {
    const username = form.username.value.trim();
    if (username.length < 3 || username.length > 50) {
        showError('–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 3 –¥–æ 50 —Å–∏–º–≤–æ–ª–æ–≤');
        return false;
    }
    return true;
}
</script>
```

---

### 2. ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.7**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `alert()` –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö –Ω–µ—É–¥–æ–±–Ω–æ.
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - —Å–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ toast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π, –∑–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ alert() –Ω–∞ toast, —É–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ AJAX –æ—à–∏–±–æ–∫  
**–í–µ—Ä—Å–∏—è:** 1.4.7 (2025-12-16)

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –°–æ–∑–¥–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (toast)
function showNotification(message, type = 'info', duration = 3000) {
    const toast = document.createElement('div');
    toast.className = `toast toast-${type}`;
    toast.textContent = message;
    document.body.appendChild(toast);
    
    setTimeout(() => {
        toast.classList.add('show');
    }, 10);
    
    setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 300);
    }, duration);
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
showNotification('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
showNotification('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞', 'error');
```

---

### 3. ‚úÖ –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏ - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.8**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –ø–æ–¥—Å–∫–∞–∑–æ–∫ –ø—Ä–∏ –≤–≤–æ–¥–µ –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - —Å–æ–∑–¥–∞–Ω API endpoint `/api/get_chip_codes`, –¥–æ–±–∞–≤–ª–µ–Ω HTML5 datalist, JavaScript —Å debounce –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏, title –∞—Ç—Ä–∏–±—É—Ç—ã –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª–µ–π  
**–í–µ—Ä—Å–∏—è:** 1.4.8 (2025-12-16)

**–†–µ—à–µ–Ω–∏–µ:**
```html
<!-- HTML5 datalist –¥–ª—è –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è -->
<input type="text" list="chip-codes" name="chip_name" id="chip_name">
<datalist id="chip-codes">
    <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ AJAX –∏–ª–∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ -->
</datalist>

<!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ -->
<input type="text" 
       title="–í–≤–µ–¥–∏—Ç–µ —à–∏—Ñ—Ä –∫—Ä–∏—Å—Ç–∞–ª–ª–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ.">
```

---

### 4. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω (Mobile-first)
**–°—Ç–∞—Ç—É—Å:** ‚è∏Ô∏è –ù–ï –¢–†–ï–ë–£–ï–¢–°–Ø

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:**
- –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - —Ç–∞–±–ª–∏—Ü—ã —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–∞–Ω–Ω—ã—Ö –ø–ª–æ—Ö–æ —Å–º–æ—Ç—Ä—è—Ç—Å—è –Ω–∞ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞—Ö
- –î–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Telegram –±–æ—Ç (–±—É–¥–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –ø—Ä–æ–µ–∫—Ç)
- Telegram –±–æ—Ç –±—É–¥–µ—Ç —Å–æ–≤–º–µ—â–µ–Ω —Å –æ—Å–Ω–æ–≤–Ω—ã–º –ø—Ä–æ–µ–∫—Ç–æ–º –≤ –æ–¥–Ω–æ–º Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—É–¥–æ–±–µ–Ω –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö. (–Ω–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ)

**–†–µ—à–µ–Ω–∏–µ:**
```css
/* Mobile-first –ø–æ–¥—Ö–æ–¥ */
@media (max-width: 768px) {
    .table-wrapper {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }
    
    .button, button, input[type="submit"] {
        min-height: 44px; /* –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è touch */
        min-width: 44px;
        font-size: 16px; /* –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç zoom –Ω–∞ iOS */
    }
    
    table {
        font-size: 12px;
    }
    
    th, td {
        padding: 4px;
        white-space: nowrap;
    }
    
    .container {
        padding: 10px;
    }
}

/* –£–ª—É—á—à–µ–Ω–∏–µ –¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–æ–≤ */
@media (min-width: 769px) and (max-width: 1024px) {
    .table-wrapper {
        max-height: 70vh;
    }
}
```

---

### 5. ‚úÖ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.9**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏.
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `setButtonLoading()` –¥–ª—è –∫–Ω–æ–ø–æ–∫, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è –≤—Å–µ—Ö —Ñ–æ—Ä–º, toast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è  
**–í–µ—Ä—Å–∏—è:** 1.4.9 (2025-12-16)

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –∑–∞–≥—Ä—É–∑–∫–∏
function showLoader(containerId) {
    const container = document.getElementById(containerId);
    container.innerHTML = `
        <div class="loader-wrapper">
            <div class="spinner"></div>
            <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
        </div>
    `;
}

// –ü—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
function uploadWithProgress(file, url) {
    const xhr = new XMLHttpRequest();
    const formData = new FormData();
    formData.append('file', file);
    
    xhr.upload.addEventListener('progress', (e) => {
        if (e.lengthComputable) {
            const percentComplete = (e.loaded / e.total) * 100;
            updateProgressBar(percentComplete);
        }
    });
    
    xhr.open('POST', url);
    xhr.send(formData);
}
```

---

### 6. ‚úÖ –ö–ª–∞–≤–∏–∞—Ç—É—Ä–Ω—ã–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.11**
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–ª–∞–≤–∏–∞—Ç—É—Ä–Ω—ã–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü: Enter (–ø–æ–∏—Å–∫/–æ—Ç–ø—Ä–∞–≤–∫–∞), Ctrl+S/Cmd+S (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å), Esc (–∑–∞–∫—Ä—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è/—Ñ–æ—Ä–º—ã)  
**–í–µ—Ä—Å–∏—è:** 1.4.11 (2025-12-16)

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
document.addEventListener('keydown', (e) => {
    // Ctrl+S –∏–ª–∏ Cmd+S - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
    if ((e.ctrlKey || e.metaKey) && e.key === 's') {
        e.preventDefault();
        if (document.activeElement.tagName !== 'INPUT' && 
            document.activeElement.tagName !== 'TEXTAREA') {
            saveCurrentForm();
        }
    }
    
    // Esc - –∑–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
    if (e.key === 'Escape') {
        closeModal();
    }
    
    // Enter –≤ –ø–æ–∏—Å–∫–µ
    if (e.key === 'Enter' && e.target.id === 'chip_name') {
        performSearch();
    }
});
```

---

### 7. ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.12**
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏–ª–∏ –æ—á–∏—Å—Ç–∫–µ –∫–æ—Ä–∑–∏–Ω—ã.
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - —Å–æ–∑–¥–∞–Ω–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `confirmAction()` –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –æ—á–∏—Å—Ç–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã, —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
**–í–µ—Ä—Å–∏—è:** 1.4.12 (2025-12-16)

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
function confirmAction(message, callback) {
    const modal = document.createElement('div');
    modal.className = 'modal-confirm';
    modal.innerHTML = `
        <div class="modal-content">
            <h3>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</h3>
            <p>${message}</p>
            <div class="modal-actions">
                <button class="btn-confirm" onclick="this.closest('.modal-confirm').remove(); callback();">–î–∞</button>
                <button class="btn-cancel" onclick="this.closest('.modal-confirm').remove();">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    `;
    document.body.appendChild(modal);
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
confirmAction('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã?', () => {
    clearCart();
});
```

---

### 8. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ —Ç–µ—Ä—è—é—Ç—Å—è.

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
function saveFilters() {
    const filters = {
        manufacturer: document.getElementById('manufacturer').value,
        lot_filter: document.getElementById('lot_filter').value,
        chip_name: document.getElementById('chip_name').value
    };
    localStorage.setItem('searchFilters', JSON.stringify(filters));
}

// –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
function restoreFilters() {
    const saved = localStorage.getItem('searchFilters');
    if (saved) {
        const filters = JSON.parse(saved);
        document.getElementById('manufacturer').value = filters.manufacturer || 'all';
        document.getElementById('lot_filter').value = filters.lot_filter || 'all';
        document.getElementById('chip_name').value = filters.chip_name || '';
    }
}

window.addEventListener('DOMContentLoaded', restoreFilters);
```

---

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### 1. –ü—É–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û (v1.4.14)
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, —á—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–æ –∏ –Ω–∞–≥—Ä—É–∂–∞–µ—Ç –ë–î.

**–†–µ—à–µ–Ω–∏–µ:**
```python
from psycopg2 import pool
import threading

# –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ø—É–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
_db_pool = None
_pool_lock = threading.Lock()

def init_db_pool():
    """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—É–ª–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
    global _db_pool
    if _db_pool is None:
        with _pool_lock:
            if _db_pool is None:
                _db_pool = psycopg2.pool.ThreadedConnectionPool(
                    minconn=1,
                    maxconn=20,
                    host=os.getenv('DB_HOST'),
                    database=os.getenv('DB_NAME') or os.getenv('DB_NAME2'),
                    user=os.getenv('DB_USER'),
                    password=os.getenv('DB_PASSWORD'),
                    port=os.getenv('DB_PORT', '5432')
                )
                _flask_app.logger.info("–ü—É–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
    return _db_pool

def get_db_connection():
    """–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–∑ –ø—É–ª–∞"""
    pool = init_db_pool()
    return pool.getconn()

def return_db_connection(conn):
    """–í–æ–∑–≤—Ä–∞—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –ø—É–ª"""
    if _db_pool:
        _db_pool.putconn(conn)

def execute_query(query, params=None, fetch=True):
    conn = None
    try:
        conn = get_db_connection()  # –ò–∑ –ø—É–ª–∞
        cur = conn.cursor()
        # ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
        cur.close()
        return results
    except Exception as e:
        if conn:
            conn.rollback()
        raise
    finally:
        if conn:
            return_db_connection(conn)  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ –ø—É–ª

# –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
def close_db_pool():
    if _db_pool:
        _db_pool.closeall()
```

---

### 2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û (v1.4.15)
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–∏, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, –ø–∞—Ä—Ç–∏–∏) –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:**
```python
from functools import lru_cache
from datetime import timedelta

# –ü—Ä–æ—Å—Ç–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å TTL
_cache = {}
_cache_timestamps = {}

def cached_query(cache_key, ttl_seconds=300):
    """–î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤"""
    def decorator(func):
        def wrapper(*args, **kwargs):
            now = datetime.now()
            if cache_key in _cache:
                timestamp = _cache_timestamps.get(cache_key)
                if timestamp and (now - timestamp).seconds < ttl_seconds:
                    return _cache[cache_key]
            
            result = func(*args, **kwargs)
            _cache[cache_key] = result
            _cache_timestamps[cache_key] = now
            return result
        return wrapper
    return decorator

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
@cached_query('manufacturers', ttl_seconds=600)  # 10 –º–∏–Ω—É—Ç
def get_manufacturers():
    return execute_query("SELECT DISTINCT name_pr FROM pr ORDER BY name_pr")
```

**–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Flask-Caching —Å Redis:**
```python
from flask_caching import Cache

cache = Cache(_flask_app, config={
    'CACHE_TYPE': 'redis',
    'CACHE_REDIS_URL': os.getenv('REDIS_URL', 'redis://localhost:6379/0'),
    'CACHE_DEFAULT_TIMEOUT': 300
})

@cache.memoize(timeout=600)
def get_manufacturers():
    return execute_query("SELECT DISTINCT name_pr FROM pr ORDER BY name_pr")
```

---

### 3. –ò–Ω–¥–µ–∫—Å—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û (v1.4.16)
**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–Ω–¥–µ–∫—Å–æ–≤
SELECT tablename, indexname, indexdef 
FROM pg_indexes 
WHERE schemaname = 'public' 
ORDER BY tablename, indexname;

-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª–µ–π
CREATE INDEX IF NOT EXISTS idx_users_username ON users(username);
CREATE INDEX IF NOT EXISTS idx_users_email ON users(email);
CREATE INDEX IF NOT EXISTS idx_cart_user_warehouse ON cart(user_id, warehouse_type);
CREATE INDEX IF NOT EXISTS idx_cart_item_id ON cart(item_id);
CREATE INDEX IF NOT EXISTS idx_invoice_status ON invoice(status);
CREATE INDEX IF NOT EXISTS idx_invoice_item_id ON invoice(item_id);
CREATE INDEX IF NOT EXISTS idx_consumption_item_id ON consumption(item_id);
CREATE INDEX IF NOT EXISTS idx_invoice_date ON invoice(date);
CREATE INDEX IF NOT EXISTS idx_consumption_date ON consumption(date);

-- –°–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
CREATE INDEX IF NOT EXISTS idx_invoice_status_date ON invoice(status, date);
```

---

### 4. –ü–∞–≥–∏–Ω–∞—Ü–∏—è –±–æ–ª—å—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û (v1.4.17)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:**
```python
@_flask_app.route('/search', methods=['GET', 'POST'])
def search():
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...
    
    # –ü–∞–≥–∏–Ω–∞—Ü–∏—è
    page = request.args.get('page', 1, type=int)
    per_page = request.args.get('per_page', 50, type=int)
    per_page = min(per_page, 200)  # –ú–∞–∫—Å–∏–º—É–º 200 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    
    offset = (page - 1) * per_page
    
    query_search += f" ORDER BY display_item_id LIMIT {per_page} OFFSET {offset}"
    
    # –ü–æ–¥—Å—á–µ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ (–¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏)
    count_query = query_search.replace("SELECT", "SELECT COUNT(*) as total", 1)
    count_query = re.sub(r'ORDER BY.*', '', count_query)
    total_count = execute_query(count_query, tuple(params_search))[0][0]
    total_pages = (total_count + per_page - 1) // per_page
    
    return render_template('search.html',
                           results=results,
                           page=page,
                           per_page=per_page,
                           total_pages=total_pages,
                           total_count=total_count,
                           ...)
```

```html
<!-- –í —à–∞–±–ª–æ–Ω–µ search.html -->
{% if total_pages > 1 %}
<div class="pagination">
    {% if page > 1 %}
        <a href="?page={{ page - 1 }}&{{ request.query_string.decode() }}" class="pagination-link">–ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
    {% endif %}
    
    {% for p in range(1, total_pages + 1) %}
        {% if p == page %}
            <span class="pagination-current">{{ p }}</span>
        {% elif p <= 3 or p >= total_pages - 2 or (p >= page - 1 and p <= page + 1) %}
            <a href="?page={{ p }}&{{ request.query_string.decode() }}" class="pagination-link">{{ p }}</a>
        {% elif p == 4 or p == total_pages - 3 %}
            <span class="pagination-ellipsis">...</span>
        {% endif %}
    {% endfor %}
    
    {% if page < total_pages %}
        <a href="?page={{ page + 1 }}&{{ request.query_string.decode() }}" class="pagination-link">–°–ª–µ–¥—É—é—â–∞—è</a>
    {% endif %}
</div>
{% endif %}
```

---

### 5. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `EXPLAIN ANALYZE` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò–∑–±–µ–≥–∞—Ç—å SELECT * (–≤—ã–±–∏—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JOIN –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è –≤ WHERE –∏ JOIN
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å COUNT –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (–±–µ–∑ JOIN —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤)
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (> 1 —Å–µ–∫—É–Ω–¥—ã)

```python
# –ü–ª–æ—Ö–æ (N+1 –ø—Ä–æ–±–ª–µ–º–∞):
for user in users:
    cart_items = execute_query("SELECT * FROM cart WHERE user_id = %s", (user.id,))

# –•–æ—Ä–æ—à–æ (–æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å):
cart_items = execute_query(
    "SELECT u.*, c.* FROM users u LEFT JOIN cart c ON u.id = c.user_id"
)
```

‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û (v1.4.18)**
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (> 1 —Å–µ–∫—É–Ω–¥—ã) –≤ `execute_query()`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `EXPLAIN ANALYZE` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–ª–∞–Ω–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω COUNT –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏: —Å–æ–∑–¥–∞–µ—Ç—Å—è —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –±–µ–∑ JOIN —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
- –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–¥—Å—á–µ—Ç–∞ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞

---

## üõ† –î—Ä—É–≥–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. REST API endpoints
**–†–µ—à–µ–Ω–∏–µ:**
- –í—ã–¥–µ–ª–∏—Ç—å REST API –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Flask-RESTful –∏–ª–∏ Flask-RESTX
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API (/api/v1/...)

```python
from flask_restful import Resource, Api

api = Api(_flask_app, prefix='/api/v1')

class SearchResource(Resource):
    def get(self):
        # API –¥–ª—è –ø–æ–∏—Å–∫–∞
        return {'results': [...]}

api.add_resource(SearchResource, '/search')
```

‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û (v1.4.19)**
- –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ REST API —Å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º (/api/v1/)
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ endpoints:
  - GET /api/v1/search - –ø–æ–∏—Å–∫ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
  - GET /api/v1/chip-codes - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —à–∏—Ñ—Ä–æ–≤ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤
  - GET /api/v1/manufacturers - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π
  - GET /api/v1/lots - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–∞—Ä—Ç–∏–π
  - GET /api/v1/cart - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - POST /api/v1/cart - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
  - DELETE /api/v1/cart/<item_id> - —É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `api_response()` –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ API
- –í—Å–µ –æ—Ç–≤–µ—Ç—ã API –∏–º–µ—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å –ø–æ–ª—è–º–∏ success, version, data, message, errors

---

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã (pytest)
- –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (OWASP ZAP)

```python
# tests/test_auth.py
import pytest
from app import _flask_app

@pytest.fixture
def client():
    _flask_app.config['TESTING'] = True
    with _flask_app.test_client() as client:
        yield client

def test_login_success(client):
    response = client.post('/login', data={
        'username': 'testuser',
        'password': 'testpass'
    })
    assert response.status_code == 302  # —Ä–µ–¥–∏—Ä–µ–∫—Ç

def test_login_failure(client):
    response = client.post('/login', data={
        'username': 'wronguser',
        'password': 'wrongpass'
    })
    assert b'–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å' in response.data
```

‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û (v1.4.20)**
- –î–æ–±–∞–≤–ª–µ–Ω pytest –∏ pytest-cov –≤ requirements.txt
- –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤ (–ø–∞–ø–∫–∞ tests/ —Å conftest.py)
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (test_auth.py):
  - –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—Ö–æ–¥–∞
  - –¢–µ—Å—Ç –≤—Ö–æ–¥–∞ —Å –ø—É—Å—Ç—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
  - –¢–µ—Å—Ç –≤—Ö–æ–¥–∞ —Å –Ω–µ–≤–µ—Ä–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
  - –¢–µ—Å—Ç –≤—ã—Ö–æ–¥–∞
  - –¢–µ—Å—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
  - –¢–µ—Å—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è REST API endpoints (test_api.py):
  - –¢–µ—Å—Ç—ã –¥–ª—è GET /api/v1/search
  - –¢–µ—Å—Ç—ã –¥–ª—è GET /api/v1/chip-codes
  - –¢–µ—Å—Ç—ã –¥–ª—è GET /api/v1/manufacturers
  - –¢–µ—Å—Ç—ã –¥–ª—è GET /api/v1/lots
  - –¢–µ—Å—Ç—ã –¥–ª—è GET /api/v1/cart
  - –¢–µ—Å—Ç—ã –¥–ª—è DELETE /api/v1/cart/<item_id>
  - –¢–µ—Å—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –æ—Ç–≤–µ—Ç–æ–≤ API
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ (test_routes.py):
  - –¢–µ—Å—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü (home, search, cart)
  - –¢–µ—Å—Ç—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
  - –¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ 404 –æ—à–∏–±–æ–∫
- –°–æ–∑–¥–∞–Ω pytest.ini —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –∏ –º–∞—Ä–∫–µ—Ä–∞–º–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤
- –°–æ–∑–¥–∞–Ω README.md –≤ –ø–∞–ø–∫–µ tests/ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ –∑–∞–ø—É—Å–∫—É —Ç–µ—Å—Ç–æ–≤

---

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û (v1.4.21)

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `logging_config.py` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (JSON —Ñ–æ—Ä–º–∞—Ç—ã)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–æ—Ç–∞—Ü–∏–µ–π (app.log –∏ errors.log)
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä (ExtendedFormatter) —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω middleware –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ —Å request_id –∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–ª–µ—Ä—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ SMTP (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)

**–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ (–≤–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `LOG_JSON_FORMAT=true`)
- –§–∞–π–ª–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–æ—Ç–∞—Ü–∏–µ–π (10 MB, 10 —Ñ–∞–π–ª–æ–≤ –±—ç–∫–∞–ø–∞)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å request_id, user_id, ip_address, duration_ms (–≤–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `LOG_ALL_REQUESTS=true`)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ (status_code >= 400) –∏ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (>1000ms)
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ request_id –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤ (–≤–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `INCLUDE_REQUEST_ID_HEADER=true`)

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
- `LOG_JSON_FORMAT` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JSON —Ñ–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false)
- `LOG_LEVEL` - —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: DEBUG, INFO, WARNING, ERROR, CRITICAL (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é INFO)
- `LOG_DIR` - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é logs/ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞)
- `LOG_ALL_REQUESTS` - –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ –∏ –º–µ–¥–ª–µ–Ω–Ω—ã–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false)
- `INCLUDE_REQUEST_ID_HEADER` - –¥–æ–±–∞–≤–ª—è—Ç—å X-Request-ID –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false)

**–§–∞–π–ª—ã:**
- `web_app_WebChip/logging_config.py` - –º–æ–¥—É–ª—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- `web_app_WebChip/logs/app.log` - –≤—Å–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `web_app_WebChip/logs/errors.log` - —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ (ERROR –∏ –≤—ã—à–µ)

---

### 4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û (v1.4.22)

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown (`web_app_WebChip/API_DOCUMENTATION.md`)
- ‚úÖ –°–æ–∑–¥–∞–Ω–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`USER_GUIDE.md`)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é (`DEPLOYMENT.md`)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**

1. **API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** (`web_app_WebChip/API_DOCUMENTATION.md`):
   - –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö REST API endpoints (v1)
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Ñ–æ—Ä–º–∞—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
   - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏—è HTTP –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

2. **–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** (`USER_GUIDE.md`):
   - –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã —Å —Å–∏—Å—Ç–µ–º–æ–π
   - –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
   - –†–∞–±–æ—Ç–∞ —Å –ø–æ–∏—Å–∫–æ–º, –∫–æ—Ä–∑–∏–Ω–æ–π, —Å–∫–ª–∞–¥–æ–º
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (–¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)
   - –ö–ª–∞–≤–∏–∞—Ç—É—Ä–Ω—ã–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è
   - FAQ

3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é** (`DEPLOYMENT.md`):
   - –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
   - –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å Docker
   - Production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å nginx –∏ systemd
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

**–§–∞–π–ª—ã:**
- `web_app_WebChip/API_DOCUMENTATION.md` - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è REST API
- `USER_GUIDE.md` - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `DEPLOYMENT.md` - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

**–û–±–Ω–æ–≤–ª–µ–Ω–æ:**
- `README.md` - –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ –Ω–æ–≤—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

### 5. –ò–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è (i18n)
**–°—Ç–∞—Ç—É—Å:** ‚è∏Ô∏è –û–¢–õ–û–ñ–ï–ù–û (–Ω–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** 
- –í—Å–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∫–æ–º–ø–∞–Ω–∏–∏ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ
- –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤ —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç
- –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ –±—É–¥—É—â–µ–º –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

**–†–µ—à–µ–Ω–∏–µ (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏):**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∑—ã–∫–æ–≤ (Flask-Babel)
- –í—ã–Ω–æ—Å –≤—Å–µ—Ö —Ç–µ–∫—Å—Ç–æ–≤ –≤ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–≤–æ–¥–æ–≤

```python
from flask_babel import Babel, _, get_locale

babel = Babel(_flask_app)

@babel.localeselector
def get_locale():
    return session.get('language', 'ru')

# –í –∫–æ–¥–µ:
flash(_('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!'), 'success')

# –í —à–∞–±–ª–æ–Ω–∞—Ö:
<h1>{{ _('–ü–æ–∏—Å–∫ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤') }}</h1>
```

---

### 6. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
**–†–µ—à–µ–Ω–∏–µ:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î
- –•—Ä–∞–Ω–µ–Ω–∏–µ backup —Ñ–∞–π–ª–æ–≤ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

```python
# scripts/backup_db.py
import subprocess
import datetime
import os

def backup_database():
    timestamp = datetime.datetime.now().strftime('%Y%m%d_%H%M%S')
    backup_file = f'backup_{timestamp}.sql'
    
    cmd = [
        'pg_dump',
        '-h', os.getenv('DB_HOST'),
        '-U', os.getenv('DB_USER'),
        '-d', os.getenv('DB_NAME'),
        '-F', 'c',  # custom format
        '-f', backup_file
    ]
    
    subprocess.run(cmd, env={**os.environ, 'PGPASSWORD': os.getenv('DB_PASSWORD')})
    return backup_file
```

---

### 7. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥)

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- ‚úÖ –§—É–Ω–∫—Ü–∏—è "–ó–∞–±—ã–ª –ø–∞—Ä–æ–ª—å" —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å
- ‚úÖ –ú–∞—Ä—à—Ä—É—Ç—ã `/forgot_password` –∏ `/reset_password` —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è —Å —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–¢–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç
4. –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –æ—Ç–≤–µ—Ç–µ –ø–∞—Ä–æ–ª—å —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ (—á–µ—Ä–µ–∑ email):**
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è —á–µ—Ä–µ–∑ email —Å —Ç–æ–∫–µ–Ω–æ–º
- –û—Ç–ø—Ä–∞–≤–∫–∞ email —Å —Ç–æ–∫–µ–Ω–æ–º —Å–±—Ä–æ—Å–∞ (–≤–º–µ—Å—Ç–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞)
- –°—Å—ã–ª–∫–∞ –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º
- –ë–æ–ª–µ–µ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–±, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SMTP

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–∞. –ú–µ—Ç–æ–¥ —á–µ—Ä–µ–∑ email –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–ø—Ü–∏—è –≤ –±—É–¥—É—â–µ–º.

---

### 8. –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (2FA)
**–†–µ—à–µ–Ω–∏–µ:**
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è 2FA –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TOTP (Google Authenticator)

```python
import pyotp
import qrcode
from io import BytesIO
import base64

def generate_2fa_secret(user_id):
    secret = pyotp.random_base32()
    query = "UPDATE users SET two_factor_secret = %s WHERE id = %s"
    execute_query(query, (secret, user_id), fetch=False)
    return secret

def get_2fa_qr_code(user, secret):
    totp_uri = pyotp.totp.TOTP(secret).provisioning_uri(
        name=user.username,
        issuer_name='Crystal Wafer System'
    )
    img = qrcode.make(totp_uri)
    buffered = BytesIO()
    img.save(buffered, format="PNG")
    return base64.b64encode(buffered.getvalue()).decode()
```

---

## üìä –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è —É–ª—É—á—à–µ–Ω–∏–π

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ (—Å–¥–µ–ª–∞—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ)
1. ‚úÖ **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.3.6**
2. ‚úÖ **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è SECRET_KEY** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.3.6**
3. ‚úÖ **CSRF –∑–∞—â–∏—Ç–∞** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.0**
4. ‚úÖ **Rate limiting –¥–ª—è –ª–æ–≥–∏–Ω–∞** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.1**

### üü† –í–∞–∂–Ω–æ (–≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è)
5. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.0**
6. ‚úÖ **Audit logging** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.2**
7. ‚úÖ **–ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.6**
8. ‚úÖ **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.12**
9. ‚úÖ **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.4**
10. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω —Ç–∞–±–ª–∏—Ü –∏ —Å—Ç–æ–ª–±—Ü–æ–≤** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.3**
11. ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.5**
12. ‚úÖ **–£–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–π** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.2**
13. ‚úÖ **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.7**
14. ‚úÖ **–ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.8**
15. ‚úÖ **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.9**
16. ‚úÖ **–ö–ª–∞–≤–∏–∞—Ç—É—Ä–Ω—ã–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.11**

### üü° –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ (–ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
17. ‚úÖ **–ü—É–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.14**
18. ‚úÖ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.15**
19. ‚úÖ **–ò–Ω–¥–µ–∫—Å—ã –ë–î** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.16**
20. ‚úÖ **–ü–∞–≥–∏–Ω–∞—Ü–∏—è** - **–ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.17**
21. ‚è∏Ô∏è **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

### üîµ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (–≤ –±—É–¥—É—â–µ–º)
22. ‚úÖ **REST API** - ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.19
23. ‚úÖ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.20
24. ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.21
25. ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û –≤ v1.4.22
26. ‚è∏Ô∏è **i18n** - ‚è∏Ô∏è –û–¢–õ–û–ñ–ï–ù–û (–Ω–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ - –≤—Å–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ)
27. ‚úÖ **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π** - ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û –≤ v1.3.6 (—á–µ—Ä–µ–∑ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å)
28. **2FA** - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–µ—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å feature branches –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è
- –û–±–Ω–æ–≤–ª—è—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤–º–µ—Å—Ç–µ —Å –∫–æ–¥–æ–º
- –ü—Ä–æ–≤–æ–¥–∏—Ç—å code review –ø–µ—Ä–µ–¥ –º–µ—Ä–∂–µ–º
- –î–µ–ª–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –ø–µ—Ä–µ–¥ –∫—Ä–∏—Ç–∏—á–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ (–æ—Å–æ–±–µ–Ω–Ω–æ –º–∏–≥—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª–µ–π)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ staging –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –ø–µ—Ä–µ–¥ production

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-12-17  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 3.0

---

## ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ (üî¥):** 4/4 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (100%) ‚úÖ  
**–í–∞–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏ (üü†):** 12/12 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (100%) ‚úÖ  
**–ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ (üü°):** 4/5 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (80%) ‚úÖ  
**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ (üîµ):** 4/6 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (67%) ‚úÖ  
**–ù–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ (‚è∏Ô∏è):** 2 –∑–∞–¥–∞—á–∏ –æ—Ç–ª–æ–∂–µ–Ω—ã (i18n, –º–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)

**–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å:** 24/27 –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (89%) ‚úÖ

### –°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á:

- ‚úÖ **–í—ã–ø–æ–ª–Ω–µ–Ω–æ:** 24 –∑–∞–¥–∞—á–∏
- ‚è∏Ô∏è **–û—Ç–ª–æ–∂–µ–Ω–æ (–Ω–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ):** 2 –∑–∞–¥–∞—á–∏ (i18n, –º–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è)
- ‚è≥ **–û—Å—Ç–∞–ª–æ—Å—å (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç):** 1 –∑–∞–¥–∞—á–∞ (—Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, 2FA)
