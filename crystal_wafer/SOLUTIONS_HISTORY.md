# История решений Soft_IPK

| Дата | Подпроект | Проблема | Влияние | Причина | Решение | Статус |
|------|-----------|----------|---------|---------|---------|--------|
| 2025‑11‑18 | `web_app_WebChip` | Opera не пропускает логин на `http://192.168.1.139:8087/login` | Пользователи Opera не могут попасть в систему | Несовпадение форматов логина (Polin-EP vs Polin_EP) приводило к тому, что Opera подставляла вариант без дефиса | Добавлена нормализация имени пользователя (нижний регистр, `-`→`_`) и поиск по канонической форме в `/login` и `/register` | Решено |
| 2025‑11‑18 | `web_app_WebChip` | Поиск по шифру кристалла «3» не возвращает результатов в Яндекс браузере | Пользователи не видят остатки по кристаллам | Приложение подключалось к неверной БД (`DB_NAME2`), поэтому таблицы `users`/`n_chip` отсутствовали; также не было телеметрии запроса | Подключение переведено на `DB_NAME` (с fallback на `DB_NAME2`), в `/search` включено детальное логирование параметров и SQL | Решено |
| 2025‑12‑08 | `web_app_WebChip` | Главная страница без вкладок и запуск только на 8087 | Нет единого доступа к разным складам, порт конфликтует на тестах | Не было табов и тестового порта | Добавлены три вкладки (Склад кристаллов/пластин/дальний) и запуск Flask переведён на 8089 | Решено |
| 2025‑12‑09 | `web_app_WebChip` | Необходимость работы с разными типами складов через единый интерфейс | Неудобство использования, нет разделения по складам | Отсутствие поддержки множественных складов в архитектуре | Реализована система вкладок с динамическим выбором таблиц БД, добавлено поле `warehouse_type` в таблицу `cart` | Решено |
| 2025‑12‑09 | `web_app_WebChip` | Множественные подключения к БД при обработке файлов вызывают таймауты | Ошибки `TypeError: Failed to fetch` при загрузке больших файлов | Создавалось новое подключение к БД для каждого ID lookup | Оптимизирована работа с БД: используется единое подключение и курсор для всех операций в рамках обработки одного файла | Решено |
| 2025‑12‑09 | `web_app_WebChip` | Смещение данных в таблице инвентаризации, отсутствие столбца "Примечание" | Неправильное отображение данных, ошибки экспорта | Столбец "Примечание" был закомментирован в шаблоне, но отсутствовал в SQL-запросе | Добавлен столбец "Примечание" в SQL-запрос инвентаризации и восстановлен в шаблоне и экспорте Excel | Решено |
| 2025‑12‑09 | `web_app_WebChip` | Нет визуальной обратной связи при загрузке файлов | Пользователи не понимают, обрабатывается ли файл | Отсутствие индикаторов загрузки | Добавлены spinner-индикаторы и визуальные сообщения об успехе/ошибке для всех форм загрузки | Решено |
| 2025‑12‑11 | `web_app_WebChip` | При поиске на всех складах после выбора партии и нажатия "Найти" происходил редирект на страницу входа | Неавторизованные пользователи не могли использовать поиск | В функции `search()` была проверка авторизации для POST-запросов | Удалена проверка `if 'user_id' not in session` из обработки POST-запроса в маршруте `/search` | Решено |
| 2025‑12‑11 | `web_app_WebChip` | Необходимость использования поиска и корзины без авторизации | Пользователи должны иметь возможность искать товары и добавлять их в корзину без входа в систему | Все функции поиска и корзины требовали авторизации | Реализована функция `get_temp_user_id()` для генерации временных идентификаторов для неавторизованных пользователей, убраны проверки авторизации из `/search`, `/add_to_cart`, `/cart`, `/remove_from_cart`, `/update_cart_item`, `/clear_cart` | Решено |

