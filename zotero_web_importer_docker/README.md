# Zotero Excel Importer Web Application (Dockerized)

Веб-приложение на Flask для пакетного импорта файлов и метаданных из Excel в Zotero.

## Структура проекта
zotero_web_importer_docker/
├── app/ # Исходный код приложения
│ ├── app.py # Flask-приложение
│ ├── zotero_importer_core.py # Основная логика импорта Zotero
│ ├── templates/
│ │ └── index.html # HTML-шаблон
│ ├── .env.example # Пример файла переменных окружения (не коммитить реальный .env!)
│ └── uploads_temp_excel/ # (Создается автоматически) Для временных Excel
├── Dockerfile # Инструкции для сборки Docker-образа
├── docker-compose.yml # Конфигурация для запуска через Docker Compose
├── requirements.txt # Python-зависимости
├── shared_pdfs_on_host/ # (Пример) Папка на хосте для PDF коллекций (создать и настроить)
├── app_logs/ # (Пример) Папка на хосте для логов (создается docker-compose)
└── README.md # Этот файл
## Предварительные требования

*   Docker
*   Docker Compose

## Настройка

1.  **Клонируйте репозиторий (если он есть) или скопируйте файлы проекта.**

2.  **Настройте переменные окружения для Zotero:**
    Создайте файл `.env` в корневой директории проекта (`zotero_web_importer_docker/`) по примеру `app/.env.example` (если вы его создали) или просто со следующим содержимым:
    ```env
    ZOTERO_API_KEY=ВАШ_ZOTERO_API_КЛЮЧ
    ZOTERO_GROUP_ID=ВАШ_ZOTERO_ID_ГРУППЫ
    ZOTERO_LIBRARY_TYPE=group # или user
    ```
    `docker-compose.yml` настроен на использование этого файла.

3.  **Подготовьте общую папку для PDF на хост-машине:**
    *   Создайте на хост-машине (сервере, где будет запускаться Docker) директорию, где пользователи будут размещать свои подпапки с PDF-файлами.
    *   В файле `docker-compose.yml` измените путь в секции `volumes` для сервиса `zotero-importer`, чтобы он указывал на эту созданную директорию:
      ```yaml
      volumes:
        # ЗАМЕНИТЕ /path/to/your/shared_pdfs на реальный АБСОЛЮТНЫЙ путь на хосте
        - /path/to/your/shared_pdfs:/mnt/shared_pdfs:ro 
        - ./app_logs:/app/logs 
      ```
      Например, если ваша общая папка на хосте `/srv/company_zotero_pdfs`, то строка будет:
      `- /srv/company_zotero_pdfs:/mnt/shared_pdfs:ro`
      Если вы используете относительный путь `./shared_pdfs_on_host`, создайте эту папку рядом с `docker-compose.yml`.

4.  **(Опционально) Проверьте `Dockerfile` и `requirements.txt`** на соответствие вашим нуждам (например, версия Python, дополнительные зависимости).

## Сборка и запуск

1.  **Сборка образа и запуск контейнера с помощью Docker Compose:**
    Откройте терминал в корневой директории проекта (где находится `docker-compose.yml`) и выполните:
    ```bash
    docker-compose up --build -d
    ```
    *   `--build`: Пересобрать образ, если были изменения в `Dockerfile` или коде приложения.
    *   `-d`: Запустить контейнеры в фоновом режиме.

2.  **Доступ к приложению:**
    Откройте веб-браузер и перейдите по адресу `http://localhost:8086` (или IP-адресу вашего хоста Docker, если он отличается).

3.  **Использование приложения:**
    *   Выберите Excel-файл с метаданными.
    *   Укажите **имя подпапки** (находящейся внутри вашей общей папки PDF, смонтированной в `/mnt/shared_pdfs` внутри контейнера), где лежат PDF-файлы для обработки. Скрипт будет рекурсивно искать файлы внутри этой указанной подпапки.
    *   Нажмите "Показать таблицу..." для предварительного просмотра.
    *   Нажмите "Передать данные в ZOTERO" для запуска процесса импорта.

4.  **Просмотр логов:**
    *   Логи приложения будут сохраняться в папку `app_logs/` (или другой, указанной в `docker-compose.yml`) на вашей хост-машине.
    *   Также можно посмотреть логи контейнера:
      ```bash
      docker-compose logs -f zotero-importer
      # или
      docker logs -f zotero_importer_service
      ```

## Остановка приложения

```bash
docker-compose down