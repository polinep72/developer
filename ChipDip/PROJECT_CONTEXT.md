# ChipDip - Расширенный парсер с Docker и аналитикой

## Описание проекта
Продвинутый парсер сайта ChipDip с Docker-контейнеризацией, использующий Firefox WebDriver и PostgreSQL для хранения данных. Включает веб-интерфейс с расширенной аналитикой, графиками и экспортом данных.

## Основные компоненты
- **chipdip_parser/app.py** - основное приложение парсера
- **chipdip_parser/config_loader.py** - загрузка конфигурации
- **chipdip_parser/database.py** - работа с PostgreSQL
- **chipdip_parser/scraper.py** - логика парсинга
- **chipdip_parser/scheduler.py** - планировщик задач
- **webapp/** - веб-интерфейс с аналитикой
- **docker-compose.yml** - контейнеризация
- **Dockerfile** - образ контейнера

## Функциональность
- Парсинг товаров с сайта ChipDip
- Работа с PostgreSQL базой данных
- Планировщик задач с настраиваемыми интервалами
- Веб-интерфейс для управления
- **Расширенная аналитика и статистика**
- **Интерактивные графики (Plotly.js)**
- **Экспорт данных в Excel**
- **Многопользовательская система**
- **Редактирование названий товаров**
- Логирование и мониторинг
- Docker-контейнеризация

## Технологии
- **Python** - основной язык
- **Selenium WebDriver (Firefox)** - автоматизация браузера
- **PostgreSQL** - база данных
- **Docker** - контейнеризация
- **APScheduler** - планировщик задач
- **Flask** - веб-интерфейс
- **Plotly.js** - интерактивные графики
- **openpyxl** - экспорт в Excel
- **python-pptx** - экспорт в PowerPoint

## Архитектура
```
ChipDip/
├── chipdip_parser/     # Основной модуль парсера
├── webapp/            # Веб-интерфейс
├── logs/              # Логи приложения
├── docker-compose.yml # Конфигурация Docker
└── Dockerfile         # Образ контейнера
```

## Текущий статус
- Проект функционален с Docker
- Использует Firefox WebDriver
- Интегрирован с PostgreSQL
- Имеет веб-интерфейс с аналитикой
- **6 интерактивных графиков статистики**
- **Экспорт данных в Excel с графиками**
- **Многопользовательская система**
- **Редактирование названий товаров**
- Настроен для продакшена

## Графики и аналитика
1. **График продаж по убыванию** - топ-20 товаров по продажам
2. **График продаж по месяцам** - продажи всех товаров за 12 месяцев (stacked bar)
3. **График выручки по месяцам** - выручка всех товаров за 12 месяцев (stacked bar)
4. **Остатки на складе** - динамика остатков для выбранного товара (line chart)
5. **Стоимость** - динамика цен для выбранного товара (line chart)
6. **Продажи по месяцам (товар)** - продажи выбранного товара за 12 месяцев (line chart)
7. **Выручка по месяцам (товар)** - выручка выбранного товара за 12 месяцев (bar chart)

## Известные проблемы
- Требуется настройка переменных окружения
- Необходима настройка PostgreSQL
- Требуется установка geckodriver

## Ключевые настройки
- Конфигурация загружается из .env файла
- Настройки WebDriver (headless, таймауты)
- Параметры подключения к PostgreSQL
- Настройки планировщика задач
- Логирование и мониторинг
- **Настройки экспорта Excel/PowerPoint**
- **Конфигурация графиков Plotly.js**
 - Публичные health‑эндпоинты: `GET /health`, `GET /api/health`, резерв `GET /healthz`
 - Публичный доступ к статистике: API данных графиков не требуют авторизации (в т.ч. выручка)

## Публичные API для графиков выручки
- `GET /api/stats/revenue/monthly` — общая выручка (график 3)
- `GET /api/stats/revenue/product-monthly?product_id=...` — выручка выбранного товара (график 6)
