# WSB - Workspace Booking Bot

**–í–µ—Ä—Å–∏—è:** 5.1.0  
**–û–ø–∏—Å–∞–Ω–∏–µ:** Telegram-–±–æ—Ç –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—á–∏—Ö –º–µ—Å—Ç –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

WSB (Workspace Booking Bot) - —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—á–∏—Ö –º–µ—Å—Ç —á–µ—Ä–µ–∑ Telegram-–±–æ—Ç–∞. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è, –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–∞—á–∞–ª–µ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –ø—Ä–æ–¥–ª–µ–≤–∞—Ç—å –≤—Ä–µ–º—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** - –ø–æ–¥–∞—á–∞ –∑–∞—è–≤–∫–∏ –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
- **–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è, –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—Ä–æ–Ω—è–º–∏** - –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π, –æ—Ç–º–µ–Ω–∞, –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ, –ø—Ä–æ–¥–ª–µ–Ω–∏–µ
- **–ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è** - –±—Ä–æ–Ω–∏ –ø–æ —Ä–∞–±–æ—á–∏–º –º–µ—Å—Ç–∞–º –∏ –ø–æ –¥–∞—Ç–∞–º
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ 10 –º–∏–Ω—É—Ç –¥–æ –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏** - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∞–¥–º–∏–Ω–æ–≤
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—Ä–æ–Ω—è–º–∏** - –æ—Ç–º–µ–Ω–∞ –ª—é–±—ã—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π, –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –±—Ä–æ–Ω–µ–π
- **–†–∞—Å—Å—ã–ª–∫–∏** - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è** - —Ä—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ¬´—Ç–æ–Ω–∫–∏–µ –ø—Ä–æ–∫—Å–∏¬ª –≤ –∫–æ—Ä–Ω–µ. –ö–∞–Ω–æ–Ω–∏—á–Ω—ã–π –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `wsb_bot/`. –ö–æ—Ä–Ω–µ–≤—ã–µ —Ñ–∞–π–ª—ã —Ä–µ—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏–∑ `wsb_bot/` –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ (–∞–∫—Ç—É–∞–ª—å–Ω–∞—è):
```
WSB/
‚îú‚îÄ‚îÄ main.py                    # –ü–†–û–ö–°–ò ‚Üí wsb_bot/main.py (—Ç–æ–Ω–∫–∏–π –ª–∞—É–Ω—á–µ—Ä)
‚îú‚îÄ‚îÄ bot_app.py                 # –ü–†–û–ö–°–ò ‚Üí wsb_bot/bot_app.py
‚îú‚îÄ‚îÄ config.py                  # –ü–†–û–ö–°–ò ‚Üí wsb_bot/config.py
‚îú‚îÄ‚îÄ constants.py               # –ü–†–û–ö–°–ò ‚Üí wsb_bot/constants.py
‚îú‚îÄ‚îÄ database.py                # –ü–†–û–ö–°–ò ‚Üí wsb_bot/database.py
‚îú‚îÄ‚îÄ logger.py                  # –ü–†–û–ö–°–ò ‚Üí wsb_bot/logger.py
‚îú‚îÄ‚îÄ requirements.txt           # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ docker-compose.yml         # Docker Compose (wsb_bot, heatmap)
‚îú‚îÄ‚îÄ heatmap_app/
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ heatmap_requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ heatmap_visualization.py
‚îú‚îÄ‚îÄ handlers/                  # –ü–†–û–ö–°–ò ‚Üí wsb_bot/handlers/*
‚îÇ   ‚îú‚îÄ‚îÄ user_commands.py
‚îÇ   ‚îú‚îÄ‚îÄ admin_commands.py
‚îÇ   ‚îú‚îÄ‚îÄ registration.py
‚îÇ   ‚îú‚îÄ‚îÄ callback_handlers.py
‚îÇ   ‚îî‚îÄ‚îÄ callbacks/
‚îÇ       ‚îú‚îÄ‚îÄ admin_callbacks.py
‚îÇ       ‚îú‚îÄ‚îÄ booking_callbacks.py
‚îÇ       ‚îú‚îÄ‚îÄ notification_callbacks.py
‚îÇ       ‚îú‚îÄ‚îÄ process_callbacks.py
‚îÇ       ‚îî‚îÄ‚îÄ viewing_callbacks.py
‚îú‚îÄ‚îÄ services/                  # –ü–†–û–ö–°–ò ‚Üí wsb_bot/services/*
‚îÇ   ‚îú‚îÄ‚îÄ admin_service.py
‚îÇ   ‚îú‚îÄ‚îÄ booking_service.py
‚îÇ   ‚îú‚îÄ‚îÄ equipment_service.py
‚îÇ   ‚îú‚îÄ‚îÄ notification_service.py
‚îÇ   ‚îú‚îÄ‚îÄ registration_notification_service.py
‚îÇ   ‚îî‚îÄ‚îÄ user_service.py
‚îú‚îÄ‚îÄ utils/                     # –ü–†–û–ö–°–ò ‚Üí wsb_bot/utils/*
‚îÇ   ‚îú‚îÄ‚îÄ keyboards.py
‚îÇ   ‚îú‚îÄ‚îÄ message_utils.py
‚îÇ   ‚îî‚îÄ‚îÄ time_utils.py
‚îú‚îÄ‚îÄ states/                    # –ü–†–û–ö–°–ò ‚Üí wsb_bot/states/*
‚îî‚îÄ‚îÄ wsb_bot/                   # –ö–∞–Ω–æ–Ω–∏—á–Ω—ã–π –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    ‚îú‚îÄ‚îÄ Dockerfile
    ‚îú‚îÄ‚îÄ main.py                # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
    ‚îú‚îÄ‚îÄ bot_app.py             # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è bot, db, scheduler
    ‚îú‚îÄ‚îÄ config.py
    ‚îú‚îÄ‚îÄ constants.py
    ‚îú‚îÄ‚îÄ database.py
    ‚îú‚îÄ‚îÄ logger.py
    ‚îú‚îÄ‚îÄ requirements.txt
    ‚îú‚îÄ‚îÄ handlers/
    ‚îú‚îÄ‚îÄ services/
    ‚îú‚îÄ‚îÄ utils/
    ‚îú‚îÄ‚îÄ states/
    ‚îî‚îÄ‚îÄ logs/
```

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫:
- **Python 3.10+** - –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫
- **pyTelegramBotAPI** - —Ä–∞–±–æ—Ç–∞ —Å Telegram Bot API
- **PostgreSQL** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **APScheduler** - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **psycopg2** - –¥—Ä–∞–π–≤–µ—Ä PostgreSQL
- **Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
- **users** - –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- **users_temp** - –≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–ª—è –∑–∞—è–≤–æ–∫ –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
- **categories** - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
- **equipment** - –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
- **bookings** - –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- **apscheduler_jobs** - —Ç–∞–±–ª–∏—Ü–∞ –∑–∞–¥–∞—á –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, jobstore –≤ –ø–∞–º—è—Ç–∏)

### –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö:
```sql
-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
users (id, users_id, first_name, last_name, fi, date, is_admin, is_blocked)

-- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–∑–∞—è–≤–∫–∏)
users_temp (id, users_id, first_name, last_name, fi, date)

-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
categories (id, name)

-- –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
equipment (id, name, category_id, note)

-- –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
bookings (id, user_id, equipment_id, time_start, time_end, status, created_at)
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env):
```env
# Telegram Bot
TELEGRAM_BOT_TOKEN=your_bot_token

# Database
DB_NAME=wsb_db
DB_USER=wsb_user
DB_PASSWORD=your_password
DB_HOST=localhost
DB_PORT=5432

# Scheduler
SCHEDULER_TIMEZONE=Europe/Moscow
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã:
- **BOOKING_TIME_STEP_MINUTES** = 30 - —à–∞–≥ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- **MAX_BOOKING_DURATION_HOURS** = 8 - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±—Ä–æ–Ω–∏
- **WORKING_HOURS_START** = 08:00 - –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è
- **WORKING_HOURS_END** = 20:00 - –∫–æ–Ω–µ—Ü —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è
- **NOTIFICATION_BEFORE_START_MINUTES** = 10 - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–æ –Ω–∞—á–∞–ª–∞
- **NOTIFICATION_BEFORE_END_MINUTES** = 10 - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:**
```bash
git clone <repository_url>
cd WSB
```

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
```bash
pip install -r requirements.txt
```

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**
```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
CREATE DATABASE wsb_db;
CREATE USER wsb_user WITH PASSWORD 'your_password';
GRANT ALL PRIVILEGES ON DATABASE wsb_db TO wsb_user;
```

4. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü (–µ—Å–ª–∏ –µ—Å—Ç—å)
# –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –≤—Ä—É—á–Ω—É—é –ø–æ —Å—Ö–µ–º–µ –≤—ã—à–µ
```

5. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª
```

6. **–ó–∞–ø—É—Å–∫:**
```bash
python main.py
```

### Docker —É—Å—Ç–∞–Ω–æ–≤–∫–∞:

1. **–°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫:**
```bash
docker compose up -d --build wsb_bot
docker compose up -d --build heatmap
```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤:**
```bash
docker compose logs -f wsb_bot
```

3. **–ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –±–æ—Ç–∞ (–ø–æ—Å–ª–µ –ø—Ä–∞–≤–æ–∫):**
```bash
docker compose build wsb_bot
docker compose up -d wsb_bot
```

## üì± –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã:
- `/start` - –°—Ç–∞—Ä—Ç/–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
- `/help` - –ü–æ–º–æ—â—å
- `/booking` - –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ
- `/mybookings` - –ú–æ–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- `/cancel` - –û—Ç–º–µ–Ω–∏—Ç—å –±—Ä–æ–Ω—å
- `/finish` - –ó–∞–≤–µ—Ä—à–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
- `/extend` - –ü—Ä–æ–¥–ª–∏—Ç—å –±—Ä–æ–Ω—å
- `/workspacebookings` - –ë—Ä–æ–Ω–∏ –ø–æ —Ä–∞–±–æ—á–∏–º –º–µ—Å—Ç–∞–º
- `/datebookings` - –ë—Ä–æ–Ω–∏ –ø–æ –¥–∞—Ç–µ

### –ê–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã:
- `/adminhelp` - –ü–æ–º–æ—â—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
- `/add_equipment` - –î–æ–±–∞–≤–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
- `/manage_equipment` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º
- `/admin_cancel` - –û—Ç–º–µ–Ω–∏—Ç—å –ª—é–±—É—é –±—Ä–æ–Ω—å
- `/all` - –û—Ç—á–µ—Ç –ø–æ –≤—Å–µ–º –±—Ä–æ–Ω—è–º
- `/broadcast` - –†–∞—Å—Å—ã–ª–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- `/users` - –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `/manage_user` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `/schedule` - –û–±–Ω–æ–≤–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## üîÑ –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ APScheduler:
- **–ó–∞–ø—É—Å–∫:** –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–ª–∞–Ω–∏—Ä—É—é—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –±—Ä–æ–Ω–µ–π
- **–¢–∞–π–º–∑–æ–Ω—ã:** Scheduler –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è pytz-—Ç–∞–π–º–∑–æ–Ω–æ–π (—á–µ—Ä–µ–∑ `pytz.timezone(SCHEDULER_TIMEZONE)`). –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è: –µ—Å–ª–∏ —É tz –µ—Å—Ç—å `localize()` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–Ω, –∏–Ω–∞—á–µ `replace(tzinfo=...)` (–¥–ª—è `zoneinfo`).
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–∞—á–∞–ª–µ:** –ó–∞ 10 –º–∏–Ω—É—Ç –¥–æ –Ω–∞—á–∞–ª–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ–∫–æ–Ω—á–∞–Ω–∏–∏:** –ó–∞ 10 –º–∏–Ω—É—Ç –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø—Ä–æ–¥–ª–µ–Ω–∏—è
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ:** –ë—Ä–æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ misfire:** –ï—Å–ª–∏ –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞ —É–∂–µ –ø—Ä–æ—à–ª–æ, –Ω–æ –ø—Ä–æ—Å—Ä–æ—á–∫–∞ ‚â§ `SCHEDULER_MISFIRE_GRACE_TIME` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 300 —Å–µ–∫), –∑–∞–¥–∞—á–∞ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –Ω–∞ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫, —á—Ç–æ–±—ã –Ω–µ —Ç–µ—Ä—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

### –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏—è:
1. –ó–∞ 10 –º–∏–Ω—É—Ç –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
2. –ï—Å–ª–∏ –µ—Å—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–π –±—Ä–æ–Ω–∏, –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –ø—Ä–æ–¥–ª–µ–Ω–∏–µ
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–¥–ª–µ–Ω–∏—è (30 –º–∏–Ω, 1 —á–∞—Å, 2 —á–∞—Å–∞)
4. –ü—Ä–∏ –ø—Ä–æ–¥–ª–µ–Ω–∏–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π (–ò–°–ü–†–ê–í–õ–ï–ù–ê):
- **–°–∏–º–ø—Ç–æ–º:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü—É `users_temp`, –∞–¥–º–∏–Ω –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- **–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–Ω—Ñ–ª–∏–∫—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ `/start` –≤ `user_commands.py` –∏ `registration.py`
- **–†–µ—à–µ–Ω–∏–µ:** –û–±—Ä–∞–±–æ—Ç—á–∏–∫ `/start` –≤ `user_commands.py` –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ (–ò–°–ü–†–ê–í–õ–ï–ù–ê):
- **–°–∏–º–ø—Ç–æ–º:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–∞–¥–∞–ª–∏ —Å –æ—à–∏–±–∫–æ–π `'zoneinfo.ZoneInfo' object has no attribute 'localize'`
- **–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–Ω—Ñ–ª–∏–∫—Ç –º–µ–∂–¥—É `pytz.timezone` –∏ `zoneinfo.ZoneInfo` –≤ Python 3.9+
- **–†–µ—à–µ–Ω–∏–µ:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏: `localize()` –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏, –∏–Ω–∞—á–µ `replace(tzinfo=...)`. Scheduler –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è pytz-—Ç–∞–π–º–∑–æ–Ω–æ–π.
- **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ misfire (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö grace).
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:
- **–†–∞–±–æ—Ç–∞–µ—Ç:** –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä—É—é—Ç—Å—è –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–æ–≤:
- **INFO** - –æ—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ
- **DEBUG** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **WARNING** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- **ERROR** - –æ—à–∏–±–∫–∏
- **CRITICAL** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

### –§–∞–π–ª—ã –ª–æ–≥–æ–≤:
- `logs/app.log` - –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `logs/network.log` - —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ –ø–æ –¥–Ω—è–º

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞:
- **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ handlers, services, utils
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ type hints
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - try/catch –±–ª–æ–∫–∏ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π:
1. –í–Ω–æ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–∞–Ω–æ–Ω–∏—á–Ω—ã–π –∫–æ–¥ –≤ `wsb_bot/`
2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ ‚Äî `wsb_bot/handlers/`, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ ‚Äî `wsb_bot/services/`
3. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ `wsb_bot/constants.py`
4. –î–æ–±–∞–≤—å—Ç–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –≤ `wsb_bot/utils/keyboards.py`

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

## üë• –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ `logs/app.log`
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** 3.2 
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-11-19
