# Контекст проекта Soft_IPK

## Описание
Многоуровневая сборка внутренних инструментов Soft_IPK, объединяющая несколько веб‑приложений и сервисов (Python/Poetry, Node.js, вспомогательные утилиты). Приложения обслуживают разные рабочие сценарии (управление заказами, чат‑боты, аналитические панели, экспорт данных).

## Версия
**Текущая версия: 1.2.0** (обновлено: 2025-12-09)

## Основные компоненты
- `backend/` — основной Python‑бэкенд (Poetry), вероятно реализует API/авторизацию.
- `frontend/` — отдельный Node.js фронтенд (React/Vite или аналогичный SPA).
- `web_app_WebChip/` — Flask веб-приложение для управления складом кристаллов и пластин:
  - Система управления тремя типами складов: Склад кристаллов, Склад пластин, Дальний склад
  - Функциональность поиска, прихода, расхода, возврата, инвентаризации
  - Корзина покупок с разделением по типам складов
  - Экспорт данных в Excel
  - HTML шаблоны в `templates/`
- `web_app_dash/`, `telegram_bot_HMCB/`, `T-Helper/` — дополнительные сервисы (dash-приложение, Telegram-бот, помощник с FAISS).
- `docker-compose.yml`, `Dockerfile` — корневые конфигурации развёртывания.

## Текущий статус
- Структура репозитория подтверждена, контекстные файлы созданы.
- Реализована полная поддержка работы с несколькими складами.
- Приложение работает на порту 8089 для тестирования.

## Архитектура базы данных
- **Склад кристаллов**: таблицы `invoice`, `consumption`
- **Склад пластин**: таблицы `invoice_p`, `consumption_p`
- **Дальний склад**: таблицы `invoice_f`, `consumption_f`
- **Корзина**: таблица `cart` с поддержкой `warehouse_type` для разделения по складам

## Основные функции web_app_WebChip
1. **Поиск** - поиск кристаллов по различным критериям с фильтрацией
2. **Приход** - загрузка данных о поступлении товара из Excel
3. **Расход** - загрузка данных о расходе товара из Excel
4. **Возврат** - загрузка данных о возврате товара из Excel
5. **Инвентаризация** - сводная информация по остаткам с фильтрацией
6. **Корзина** - управление отобранными товарами с возможностью экспорта

## Ключевые настройки и зависимости
- Python‑проекты используют Poetry (`pyproject.toml` в корне и в `backend/`).
- Несколько Docker Compose файлов для отдельных сервисов, что указывает на микросервисный деплой.
- `web_app_WebChip` использует Flask с HTML шаблонами в `templates/` и Jinja2.
- База данных: PostgreSQL (подключение через `psycopg2`)

## Архитектура и связи
- Веб‑приложения могут обмениваться данными через общий API (`backend/`).
- Общие ресурсы: БД/файлы экспорта (`web_app_WebChip/exported_files`, `temp`).
- Telegram боты и вспомогательные сервисы используют собственные Docker‑окружения, но могут потреблять тот же API/БД.

## Последние изменения (v1.2.0)
- Добавлена система управления несколькими складами
- Реализованы отдельные корзины для каждого склада
- Добавлены индикаторы загрузки для всех форм
- Оптимизирована работа с базой данных
- Улучшена обработка ошибок и логирование

